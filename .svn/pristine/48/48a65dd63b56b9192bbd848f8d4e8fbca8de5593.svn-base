<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.outbound.mapper.MsgTemplateMapper">

    <resultMap type="com.ruoyi.outbound.domain.MsgTemplate" id="MsgTemplateResult">
        <result property="id" column="id"/>
        <result property="tempName" column="temp_name"/>
        <result property="tempContent" column="temp_content"/>
        <result property="tempRegion" column="temp_region"/>
        <result property="tempTaskid" column="temp_taskid"/>
        <result property="tempLabel" column="temp_label"/>
        <result property="tempType" column="temp_type"/>
        <result property="createTime" column="create_time"/>
        <result property="updateTime" column="update_time"/>
        <result property="isDelete" column="is_delete"/>
    </resultMap>

    <select id="selectTempListPage" parameterType="com.ruoyi.outbound.domain.bo.MsgTemplateBo"
            resultMap="MsgTemplateResult">
        select * from ob_message_template t
        <where>
            <if test="msgTemplateBo.tempName != null and msgTemplateBo.tempName != ''"> and temp_name like concat('%', #{msgTemplateBo.tempName}, '%')</if>
            <if test="msgTemplateBo.tempContent != null and msgTemplateBo.tempContent != ''"> and temp_content like concat('%', #{msgTemplateBo.tempContent}, '%')</if>
            <if test="msgTemplateBo.tempRegion != null and msgTemplateBo.tempRegion != ''"> and temp_region = #{msgTemplateBo.tempRegion}</if>
            <if test="msgTemplateBo.tempType != null and msgTemplateBo.tempType != ''"> and temp_type = #{msgTemplateBo.tempType}</if>
        </where>
        order by t.create_time desc
    </select>

    <select id="selectTaskInfoList" parameterType="Integer" resultType="com.ruoyi.outbound.entity.Item">
        select id,biz_no item,name value from data_import.ob_task
        <where>
            <if test="regionId != null"> and region_id = #{regionId}</if>
        </where>
        order by create_time desc
    </select>
    <select id="selectTaskLabel" parameterType="Integer" resultType="com.ruoyi.outbound.entity.Item">
        SELECT t1.id,t1.category item,t1.desc value from
            aisp_jydp.configlabelcategory t1 LEFT JOIN aisp_jydp.flowversion t2 ON t1.VersionId = t2.Id
            left JOIN aisp_jydp.robot t3 ON t2.robotId = t3.Id
        where t3.Id = #{bizNo};
    </select>


</mapper>
